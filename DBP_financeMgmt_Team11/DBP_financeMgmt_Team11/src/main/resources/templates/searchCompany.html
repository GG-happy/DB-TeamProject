<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>기업 검색</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script>
        function selectCompany(companyID, companyName) {
            if (window.opener) {
                window.opener.document.getElementById("companyID").value = companyID;
                window.opener.document.getElementById("companyName").value = companyName;
                window.close();
            } else {
                alert("부모 창이 없습니다.");
            }
        }
    </script>
</head>
<body>
<h1>기업 검색</h1>

<!-- 검색 폼 -->
<form action="/searchCompany" method="get">
    <input type="hidden" name="_csrf" value="${_csrf.token}"/>
    <label>사업장 등록번호로 검색
        <input type="text" name="businessNo" placeholder="사업장 등록번호로 검색" th:value="${businessNo}">
    </label>
    <label>기업명으로 검색
        <input type="text" name="companyName" placeholder="기업명으로 검색" th:value="${companyName}">
    </label>
    <button type="submit">검색</button>
</form>

<h2>검색 결과</h2>
<table>
    <thead>
    <tr>
        <th>사업장 등록번호</th>
        <th>기업명</th>
        <th>기업 규모</th>
        <th>신용 등급</th>
        <th>선택</th>
    </tr>
    </thead>
    <tbody>
    <!-- 검색 결과 반복 렌더링 -->
    <tr th:each="company : ${companyList}">
        <td th:text="${company.businessNo}"></td>
        <td th:text="${company.companyName}"></td>
        <td th:text="${company.companySize}"></td>
        <td th:text="${company.creditGrade}"></td>
        <td>
            <button th:data-company-id="${company.companyId}" th:data-company-name="${company.companyName}" onclick="selectCompany(this.getAttribute('data-company-id'), this.getAttribute('data-company-name'))">선택</button>
        </td>
    </tr>
    </tbody>
</table>
</body>
</html>
